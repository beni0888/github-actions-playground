name: "Reusable workflow with status check"

on:
  push:
  workflow_dispatch:
    inputs:
      run_subworkflow:
        type: choice
        description: Call subworkflow
        default: yes
        options:
          - yes
          - no

jobs:
  call_reusable:
    if: inputs.run_subworkflow == 'yes'
    uses: ./.github/workflows/reusable-workflow.yml

  result:
    needs: call_reusable
    runs-on: ubuntu latest
    if: inputs.run_subworkflow == 'yes'
    steps:
      - name: "Check result"
        if: needs.call_reusable.result != 'success'
        run: exit 1
